{
    "collab_server" : "",
    "contents" : "#install.packages(c(\"tidyverse\", \"ggmap\", \"ggthemes\"))\nlibrary(tidyverse)\nlibrary(ggmap)\nlibrary(ggthemes) \nlibrary(lubridate)\n\n#install.packages(\"revealjs\", type = \"source\")\n\n\ndata <- read.csv(\"Export_Crime_Data.csv\", stringsAsFactors=F)\n  \nd <- data %>% select(REPORT_DAT,OFFENSE,METHOD,WARD,XBLOCK,YBLOCK)\n  \nx <- mean(d$XBLOCK)\n# -77.00819\ny <- mean(d$YBLOCK)\n# 38.90592 \n\n\nd <- data\nd$date <- mdy_hms(d$REPORT_DAT)\n\nd <- d %>% mutate(year = year(date), month = month(date), \n                  day = day(date), hour = hour(date),\n                  minute = minute(date),\n                  second = second(date))\n  \n#38.889762, -77.036216\n#38.8895? N, 77.0353? W\nd <- d %>% mutate(EW = ifelse(XBLOCK > -77.0362, \"East\", \"West\"), \n                  NS = ifelse(YBLOCK > 38.8895, \"North\", \"South\"))\n\n\n#add Quadrant\n\nd <- d %>% mutate(quad = ifelse(EW == \"West\" & NS == \"North\", \"Northwest\", \n                                ifelse(EW == \"East\" & NS == \"North\", \"Northeast\", \n                                       ifelse(EW == \"West\" & NS == \"South\", \"Southwest\",\n                                              \"Southeast\"))))\nd$quad <- as.factor(d$quad)\n\n\nd <- mutate(d, crimetype = ifelse(OFFENSE ==\"HOMICIDE\", \"Violent\",\n                           ifelse(OFFENSE ==\"SEX ABUSE\", \"Violent\",\n                           ifelse(OFFENSE ==\"ROBBERY\", \"Violent\",\n                           ifelse(OFFENSE ==\"ASSAULT W/DANGEROUS WEAPON\", \"Violent\",           \n                            \"Non-Violent\" )))))\nd$crimetype <- as.factor(d$crimetype)\n\nsave(d, file=\"crime_flat.rda\")\nwrite.csv(d, \"dc_crime_add_vars.csv\")\n\nload(\"crime_flat.rda\")\n \n\n#crimes per year\nd %>% subset(year < 2017) %>% group_by(year) %>% summarize(total = n()) %>%\n  ggplot(aes(x=year, y = total)) + geom_line(size=2) + scale_x_continuous()\n  \n#Stacked Plot\nd %>%  subset(year < 2017) %>%  group_by(year,OFFENSE) %>% summarize(total = n()) %>% \n ggplot(aes(x = year, y = total, fill = OFFENSE)) + geom_area(position = 'stack') + \n  scale_x_continuous()\n\n#HOMICIDE plot\nd %>% filter(year < 2017, OFFENSE ==\"HOMICIDE\") %>% group_by(year) %>% summarize(total = n()) %>%\n  ggplot(aes(x=year, y = total)) + geom_line() + scale_x_continuous()\n\nd %>% filter(year < 2017, OFFENSE ==\"SEX ABUSE\") %>% group_by(year) %>% summarize(total = n()) %>%\n  ggplot(aes(x=year, y = total)) + geom_line() + scale_x_continuous()\n\nd %>% filter(year < 2017, OFFENSE ==\"THEFT/OTHER\") %>% group_by(year) %>% summarize(total = n()) %>%\n  ggplot(aes(x=year, y = total)) + geom_line() + scale_x_continuous()\n\n\n\n\n#Split by Horizontal lines -> \n\nquad <- d %>% group_by(year,OFFENSE,quad) %>% summarize(total = n())\n  \nsave(quad, file=\"quad.rda\") \n\nload(\"quad.rda\")\nggplot(quad,aes(x=year, y = total, colour = quad)) + geom_line(size=1.1) + facet_wrap(~OFFENSE, scales=\"free_y\")\n\nquad <- as.data.frame(quadrant)\n\n\n\n\n#Facet Grid by Crime\nd %>% filter(year < 2017) %>% group_by(year, OFFENSE) %>% summarize(total = n()) %>%\n  ggplot(aes(x=year, y = total)) + geom_line(size=1.1) + facet_wrap(~OFFENSE, scales=\"free_y\")\n\n\n#Facet Grid with Quadrant\nd  %>% group_by(hour, OFFENSE, quad) %>% summarize(total = n()) %>%\n  ggplot(aes(x=hour, y = total, colour = quad)) + geom_line() + facet_wrap(~OFFENSE,  scales=\"free_y\")\n\n\n\n\n#Time of Day Plots\n\n#Map Plots  \nmap <- get_map(location = \"washington, dc\", zoom = 12)\nhom <- filter(d, OFFENSE==\"HOMICIDE\")\nhom <- hom %>% filter(year==2016 | year == 2017)\nggmap(map) + geom_point(data = hom, aes(x = XBLOCK, y = YBLOCK))\n\n\n\nyear <- hom %>% group_by(year) %>% summarize(total = n())\ny <- year$year\n\nmap2 <- get_map(location = \"anacostia metro, washington, dc\", zoom = 13)\n\n\nggplot(hom, aes(x=XBLOCK, y = YBLOCK, colour = METHOD)) + geom_point()\n\nfor(i in y) {\n  ggplot(hom[year == i,], aes(x=XBLOCK, y = YBLOCK, colour = METHOD)) + geom_point()\n}\n\nhom[year==2008,]\n\n#ward totals..\nd$WARD <- as.factor(d$WARD)\nd$OFFENSE <- as.factor(d$OFFENSE)\n\n\nlibrary(reshape2)\nward <- d %>% \n  group_by(WARD, OFFENSE) %>%\n  summarize(total = n()) %>% dcast(WARD ~ OFFENSE)\n\n            ",
    "created" : 1500778245736.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2167059995",
    "id" : "D690EE8C",
    "lastKnownWriteTime" : 1509712822,
    "last_content_update" : 1509712822298,
    "path" : "C:/R/dc_crime_data/scripts/S002_plot_testing.R",
    "project_path" : "scripts/S002_plot_testing.R",
    "properties" : {
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}